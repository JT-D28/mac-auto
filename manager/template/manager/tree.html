{% load static %}
<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>树组件</title>
  <link rel="stylesheet" type="text/css" href="{% static 'manager/ztree/zTreeStyle.css' %}">  
<!--   <link rel="stylesheet" type="text/css" href="{% static 'manager/ztree/demo.css' %}"> -->
  <link rel="stylesheet" type="text/css" href="{% static 'manager/font-awesome-4.7.0/css/font-awesome.min.css' %}">

  <link rel="stylesheet" type="text/css" href="{% static 'manager/bootstrap/bootstrap.min.css' %}">
  <link href="{% static 'manager/bootstrap-fileinput-master/css/fileinput.css'%}" media="all" rel="stylesheet" type="text/css"/>
  <link href="{% static 'manager/bootstrap-fileinput-master/themes/explorer-fas/theme.css'%}" media="all" rel="stylesheet" type="text/css"/>

  <link rel="stylesheet" type="text/css" href="{% static 'manager/layui/css/layui.css' %}">




  <style type="text/css">
  .ztree li span.button.add {margin-left:2px; margin-right: -1px; background-position:-144px 0; vertical-align:top; *vertical-align:middle}

  .ztree li span.button.diy01_ico_open, .ztree li span.button.diy01_ico_close{margin-right:2px; background: url(../../static/manager/ztree/img/diy/1_open.png) no-repeat scroll 0 0 transparent; vertical-align:top; *vertical-align:middle}
  .ztree li span.button.diy02_ico_docu{margin-right:2px; background: url(../../static/manager/ztree/img/diy/2.png) no-repeat scroll 0 0 transparent; vertical-align:top; *vertical-align:middle}

  .ztree li span.button.diy03_ico_docu{margin-right:2px; background: url(../../static/manager/ztree/img/diy/3.png) no-repeat scroll 0 0 transparent; vertical-align:top; *vertical-align:middle}

  .fa{

    color:#FF6699;
  }

/*.fa{
  color: #6699CC;
}*/
/*.fa.fa-plus{
  color:#CCCCCC;

}
.fa.fa-minus{
  color:#CCCCCC;

}*/

  .fa.fa-folder{
    color:#FFCC66;
  
  }

  .fa.fa-folder-open{
    color:#FFCC66;
  }

/*  .fa.fa-file-o{
    color:#c2c2c2;
  }
  .fa.fa-database{
    color:#c2c2c2;
  }
  .fa.fa-star{
    color:#FFCC00;
  }

  .fa.fa-product-hunt{

    color:#00CC99;
  }
  .fa.fa-leaf{

     color:#00CC99;
  }
  .fa.fa-home{
    color:#66CCCC;
  }
  .fa.fa-folder{
    color:#FFCC66;
  
  }

  .fa.fa-folder-open{
    color:#FFCC66;
  }

  .fa.fa-info{
    color:#FF0033;
  }
  .fa.fa-facebook{
    color: #FF9999;

  }*/



  </style>
</head>
<body>


<div style="margin-left: 100px;margin-right: 100px;">
  <div class="layui-row">
    <div class="layui-col-md4" style="border: 0px solid red;">
      <div class="layui-inline">
        <input type="input" name="" placeholder="search" class="layui-input" id='search' >
        <!-- <span class="fa fa-plus-circle" id='add_product'></span> -->
      </div>
      <ul id="case-manager" class="ztree"></ul>

    </div>
  <div class="layui-col-md1">
     <hr  style="height:600px;width:1px;margin-top:2px;margin-bottom:10px;margin-right: 2px;">
  </div>
    <div class="layui-col-md7">
     
      <!-- <div id='fuzu'></div> -->
      <span class="layui-breadcrumb" lay-separator="-"><a href="">首页</a></span>
      <iframe id='tree-content' name='tree-content' title="test" scrolling="no" frameborder="0" src="" style="width:100%;height:650px;"></iframe>
    </div>
  </div>
</div>

<div id='import-div' style="padding:5px;" hidden>
  <input id="file-explorer" type="file" multiple>
</div>


<script src="{% static 'manager/layui/layui.js' %}"></script>
<script src="{% static 'manager/js/jquery.min.js' %}"></script>
<script src="{% static 'manager/js/utils.js' %}"></script>

<script src="{% static 'manager/ztree/jquery.ztree.all.min.js' %}"></script>
<!-- <script src="{% static 'manager/ztree/jquery.ztree.core.min.js' %}"></script> -->
<script src="{% static 'manager/ztree/jquery.ztree.core.js' %}"></script>
<script src="{% static 'manager/ztree/jquery.ztree.excheck.min.js' %}"></script>
<script src="{% static 'manager/ztree/jquery.ztree.exedit.js' %}"></script>
<script src="{% static 'manager/js/mytree.js' %}"></script>

<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.bundle.min.js" crossorigin="anonymous"></script>
<script src="{% static 'manager/bootstrap-fileinput-master/js/plugins/piexif.js' %}"></script>
<script src="{% static 'manager/bootstrap-fileinput-master/js/plugins/sortable.js' %}"></script>
<script src="{% static 'manager/bootstrap-fileinput-master/js/fileinput.js' %}"></script>
<script src="{% static 'manager/bootstrap-fileinput-master/js/locales/fr.js' %}"></script>
<script src="{% static 'manager/bootstrap-fileinput-master/js/locales/es.js' %}"></script>
<script src="{% static 'manager/bootstrap-fileinput-master/themes/fas/theme.js' %}"></script>
<script src="{% static 'manager/bootstrap-fileinput-master/themes/explorer-fas/theme.js' %}"></script>
<script type="text/javascript">
tree.init()


//search
 $('#search').on('input propertychange', function() {
  console.log($('#search').val())
  tree.init($('#search').val())
});

//add

$('#add_product').click(function(e){
  layer.prompt({
    formType: 0,
    value: '',
    title: '新建产品'
  }, function(value, index, elem){
   
    layer.close(index);
    _post('/manager/treecontrol/',{'description':value,'action':'addproduct'},function(data){
      if(data.code==0)
        layer.alert(data.msg,{icon:1,time:2000})
      else
        layer.alert(data.msg,{icon:2})

    })
  })


})


//

$("#file-explorer").fileinput({
    'theme': 'explorer-fas',
    'uploadUrl': '/manager/upload/',
    'minFileCount':1,
    'uploadAsync':false,
    uploadExtraData: function(previewId, index) {   //额外参数的关键点
        var obj = {

        };
        obj.kind='dataimport'
        // obj.content_type='json'

        return obj;
    }
    // 'allowedFileTypes':['json','xlsx']
    // overwriteInitial: false,

});


$('#file-explorer').on('filebatchuploaderror', function(event, data, msg) {
  layer.alert('转换异常['+msg+']',{icon:2})
 
});

$('#file-explorer').on('filebatchuploadsuccess', function(event, data, previewId, index) { 
 // alert(JSON.stringify(data))
 // alert('success')
// console.log(data)
 response=JSON.parse(data.response)

 if(response.code==0){
  layer.alert(response.msg,{icon:1})
 }else{
  layer.alert(response.msg,{icon:2})
 }
});
</script>
</body>
</html>